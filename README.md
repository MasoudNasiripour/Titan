torch code for Titan paper
